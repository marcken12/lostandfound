<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Announcement Form</title>
    <style>
        /* Your existing styles */
    </style>
</head>
<body>
    <div class="container">
        <h1>Announcement Form</h1>

        <!-- Scanned Data Display -->
        <div id="scannedDataSection">
            <h2>Scanned Data:</h2>
            <p><strong>Name:</strong> <span id="scannedName"></span></p>
            <p><strong>Email:</strong> <span id="scannedEmail"></span></p>
            <p><strong>Phone:</strong> <span id="scannedPhone"></span></p>
            <p><strong>ID:</strong> <span id="scannedID"></span></p>
            <p><strong>Course:</strong> <span id="scannedCourse"></span></p>
            <p><strong>Serial Code:</strong> <span id="scannedSerial"></span></p>
        </div>

        <!-- Founder Information Form -->
        <form id="announcementForm">
            <input type="text" id="founderName" placeholder="Name ng nakapulot" required>
            <input type="text" id="foundTime" placeholder="Time" required>
            <input type="text" id="foundLocation" placeholder="Saan" required>
            <button type="submit">Announce</button>
        </form>

        <a href="main.html" class="back-link">Go back to Main</a>
    </div>

    <script type="text/javascript">
        // Load and display scanned data on page load
        window.addEventListener('load', function() {
            const scannedData = JSON.parse(localStorage.getItem('scannedData'));

            if (scannedData) {
                document.getElementById('scannedName').textContent = scannedData.name || '';
                document.getElementById('scannedEmail').textContent = scannedData.email || '';
                document.getElementById('scannedPhone').textContent = scannedData.phone || '';
                document.getElementById('scannedID').textContent = scannedData.id || '';
                document.getElementById('scannedCourse').textContent = scannedData.course || '';
                document.getElementById('scannedSerial').textContent = scannedData.serial || '';
            }
        });

        // Submit announcement form with additional data (using EmailJS as per your example)
        document.getElementById('announcementForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const founderName = document.getElementById('founderName').value;
            const foundTime = document.getElementById('foundTime').value;
            const foundLocation = document.getElementById('foundLocation').value;
            const scannedData = JSON.parse(localStorage.getItem('scannedData'));

            // Prepare announcement message
            const announcement = `Scanned Data - Name: ${scannedData.name}, Email: ${scannedData.email}, Phone: ${scannedData.phone}, ID: ${scannedData.id}, Course: ${scannedData.course}\n` +
                `Founder - Name: ${founderName}, Time: ${foundTime}, Location: ${foundLocation}`;

            // Send data via EmailJS
            const templateParams = {
                founder_name: founderName,
                found_time: foundTime,
                found_location: foundLocation,
                scanned_name: scannedData.name,
                scanned_email: scannedData.email,
                scanned_phone: scannedData.phone,
                scanned_id: scannedData.id,
                scanned_course: scannedData.course,
                serial_code: scannedData.serial
            };

            emailjs.send('L9XK5kdKc8yHK48VM', 'template_6i9aagp', templateParams)
                .then(response => {
                    console.log('SUCCESS!', response.status, response.text);
                    alert('Announcement has been sent!');
                    document.getElementById('announcementForm').reset();
                }, error => {
                    console.error('FAILED...', error);
                    alert('Failed to send announcement.');
                });
        });
    </script>
</body>
</html>
